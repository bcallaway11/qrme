% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/em.R
\name{em.algo.inner}
\alias{em.algo.inner}
\title{Inner part of EM-algorithm for QR with measurement error}
\usage{
em.algo.inner(
  formla,
  data,
  betmat,
  tau,
  m = 1,
  pi = 1,
  mu = 0,
  sig = 1,
  simstep = "MH",
  iters = 400,
  burnin = 200,
  drawsd = 4,
  cl = 1,
  messages = FALSE
)
}
\arguments{
\item{formla}{y ~ x}

\item{data}{a data.frame that contains y and x}

\item{betmat}{LxK matrix of parameter values with L the number of quantiles
and K the dimension of the covariates}

\item{tau}{An L-vector indicating which quantiles have been estimated}

\item{m}{The number of components of the mixture distribution for the
measurement error}

\item{pi}{The probability of each mixture component (should have length
equal to m)}

\item{mu}{The mean of each mixture component (should have length equal
to m)}

\item{sig}{The standard deviation of each mixture component (should have
length equal to m)}

\item{simstep}{Whether to use MH in EM algorithm or importance sampling
in EM algorithm.  "MH" for MH, and "ImpSamp" for importance sampling.
Default is MH.}

\item{iters}{How many iterations to use in the simulation step (default is
400)}

\item{burnin}{How many iterations to drop in the simulation step (default
is 200)}

\item{drawsd}{The starting standard deviation for the measurement error
term.}

\item{cl}{The numbe of clusters to use for parallel computation (default
is 1 so that computation is not done in parallel)}

\item{messages}{Whether or not to report details of estimation procedure
(default is FALSE)}
}
\value{
A list of QR parameters and parameters for mixture of normals for
 the measurement error term
}
\description{
Does the heavy-lifting of the EM-algorithm for QR with
 measurment error
}
\keyword{internal}
